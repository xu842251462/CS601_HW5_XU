<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Meta Info -->
    <meta charset="UTF-8">
    <meta name="description" content="BU MET CS601 - Assignment 5">
    <meta name="keywords" content="BU, MET, CS601, Assignment5, HTML">
    <meta name="author" content="Bin Xu">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Favicon -->
    <!-- Title -->
    <title>My Degrees</title>
    <!-- Stylesheets -->
    <style>
        body {
            width: 100%;
            background: radial-gradient(circle, #4dbd769c 0%, #3c888f93 100%);
        }
        .my_degrees {
            width: 60%;
            border: 3px solid #000000;
        }
        .my_degrees th, .my_degrees td {
            border: 1px solid #000000;
            padding: 2px;
        }
        .my_degrees th {
            background-color: rgb(204, 0, 0);
            color: #ffffff;
        }

        .my_degrees tr:hover {
            background-color: #dddddd;
        }
    </style>
    <!-- Scripts -->
</head>

<body>

    <button id="button">Click here to see my degrees!</button>

    <script>
        document.getElementById("button"),onclick = () => {
           const url = 'https://gist.githubusercontent.com/xu842251462/0b5f95af2d4805334a69650bfb165661/raw/2a463b8685759ddf526d17e2975f219c8ea4374f/my_degrees.json';
           getDegrees(url);
        }

        function getDegrees(url) {
            fetch(url).then(
                function (response) {
                    console.log(response.status);
                    if (!response.ok) {
                        throw new Error("HTTP status" + response.status);
                    }
                    return response.json();
                }
            ).then(
                (data) =>
                // {
                //     document.getElementById('button')
                //         .innerHTML = JSON.stringify(data)
                // }
                appendData(data)
            )
        }

        // append data fetched in table format
        function appendData(inputJson) {
            // data passed in
            // let degrees = inputJson;
            // let data = JSON.parse(inputJson);
            let my_degrees = inputJson.my_degrees;
            // key legends
            const keys = ["Year conferred", "Type", "School", "Program/Major"];

            // create table properties
            let table = document.createElement('table');
            let tableHead = document.createElement('thead');
            let tableBody = document.createElement('tbody');

            // header row
            let headerRow = document.createElement('tr');
            for (let i = 0; i < keys.length; i++) {
                let cell = document.createElement('th');
                cell.appendChild(document.createTextNode(keys[i]));
                headerRow.appendChild(cell);
            }
            tableHead.appendChild(headerRow);
            table.appendChild(tableHead);

           //  // body rows
           // for (const entry of Object.keys(degrees)) {
           //      let row = document.createElement('tr');
           //      for (let i = 0; i < keys.length; i++) {
           //          let cell = document.createElement('td');
           //          cell.appendChild(document.createElement(degrees.quotesArray);
           //          row.appendChild(cell);
           //      }
           //      tableBody.appendChild(row);
           //  }
           //  table.appendChild(tableBody);

            my_degrees.forEach(entry => {
                let row = document.createElement('tr');
                for (let i = 0; i < keys.length; i++) {
                    let cell = document.createElement('td');
                    cell.appendChild(document.createTextNode(entry.degree[keys[i]]));
                    row.appendChild(cell);
                }
                tableBody.appendChild(row);
            });
            table.appendChild(tableBody);

            // add table to body
            table.setAttribute("class", "my_degrees");
            document.body.appendChild(table);

            // hide button
            document.getElementById("button").style.visibility = 'hidden';
        };

        // function getDegrees(url) {
        //     //create new promise
        //     const myPromise = new Promise((resolve, reject) => {
        //         let condition = true;
        //         if(condition) {
        //             const workDone = 'Promise is resolved successfully.'
        //             resolve(workDone);
        //         } else {
        //             const why = 'Promise is rejected';
        //             reject(why);
        //         }
        //     });
        //
        //     // myPromise.then((input) => {
        //     //     console.log('request successful:', appendData(input));
        //     // }).catch(err => {
        //     //     console.error(err);
        //     // });
        //
        // }
        // const getDegrees = (fileName) => {
        //   return new Promise(((resolve, reject) => {
        //       let condition = true;
        //       if(condition) {
        //           const workDone = 'Promise is resolved successfully.'
        //           resolve(workDone);
        //       } else {
        //           const why = 'Promise is rejected';
        //           reject(why);
        //       }
        //   }))
        // }
        // function gertJson(url) {
        //     return new Promise(function(resolve, reject) {
        //         const req = https.get(url, res => {
        //           let json = '';
        //           res.on('data', function(chunk){json += chunk;});
        //           res.on('end', function (){resolve(JSON.parse(json));});
        //         });
        //         req.on('error', function (err){console.log(err)})
        //     });
        //
        // }


        // let url = 'https://gist.githubusercontent.com/xu842251462/0b5f95af2d4805334a69650bfb165661/raw/2a463b8685759ddf526d17e2975f219c8ea4374f/my_degrees.json'
        // let array = []
        // fetch(url).then(
        //     (value) => {
        //         console.log(value.json())
        //     }
        // ).then(
        //     (value) => {
        //         array = value
        //     }
        // )






    </script>

</body>

</html>

